<h2>Mis pedidos</h2>

<div id="app-list">

    <!-- FILTROS -->
    <div class="mb-3">

        <button class="btn btn-outline-secondary"
                data-bs-toggle="collapse"
                data-bs-target="#panelFiltros">
            Filtros
        </button>

        <div id="panelFiltros" class="collapse mt-3">
            <div class="card card-body">

                <div class="row g-2">

                    <div class="col-md-4">
                        <label>Desde</label>
                        <input type="date"
                               class="form-control"
                               v-model="desde">
                    </div>

                    <div class="col-md-4">
                        <label>Hasta</label>
                        <input type="date"
                               class="form-control"
                               v-model="hasta">
                    </div>

                    <div class="col-md-4 d-grid align-items-end">
                        <button class="btn btn-primary"
                                v-on:click="buscar">
                            Aplicar
                        </button>
                    </div>

                </div>

            </div>
        </div>

    </div>

    <!-- TABLA -->
<table class="table table-striped align-middle">
    <thead>
        <tr>
            <th># Pedido</th>
            <th>Fecha</th>
            <th>Plato</th>
            <th>Extras</th>
            <th>Estado</th>
            <th>Monto</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        <tr v-for="p in pedidos" :key="p.idPedido">
            <!-- NRO PEDIDO -->
            <td>
                <strong>#{{ p.idPedido }}</strong>
            </td>

            <!-- FECHA -->
            <td>{{ formatearFecha(p.fecha) }}</td>

            <!-- PLATO -->
            <td>
                {{ p.nombrePlato }}
            </td>

            <!-- EXTRAS -->
            <td>
                <span v-if="p.bebida" class="badge bg-info me-1">
                    {{ p.bebida }}
                </span>

                <span v-if="p.guarnicion" class="badge bg-secondary me-1">
                    {{ p.guarnicion }}
                </span>

                <span v-if="p.aderezo" class="badge bg-dark">
                    {{ p.aderezo }}
                </span>

                <span v-if="!p.bebida && !p.guarnicion && !p.aderezo"
                      class="text-muted">
                    Sin extras
                </span>
            </td>

            <!-- ESTADO -->
            <td>
                <span class="badge"
                      :class="p.estado === 'pendiente' ? 'bg-warning text-dark' : 'bg-success'">
                    {{ p.estado }}
                </span>
            </td>

            <!-- MONTO -->
            <td>
                <strong>${{ p.monto }}</strong>
            </td>

            <td>
                <button v-if="p.estado === 'pendiente'"
                class="btn btn-sm btn-success"
                v-on:click="completar(p.idPedido)">
                completar
                </button>
                <span v-else class="text-muted">
                    -
                </span>
            </td>
        </tr>
    </tbody>
</table>

    <!-- PAGINADO -->
    <nav class="d-flex justify-content-center mt-3">
        <ul class="pagination">

            <li class="page-item" :class="{ disabled: page === 1 }">
                <a class="page-link"
                   href="#"
                   v-on:click.prevent="prev">
                    «
                </a>
            </li>

            <li class="page-item"
                v-for="n in totalPages"
                :key="n"
                :class="{ active: n === page }">
                <a class="page-link"
                   href="#"
                   v-on:click.prevent="buscar">
                    {{ n }}
                </a>
            </li>

            <li class="page-item"
                :class="{ disabled: page === totalPages }">
                <a class="page-link"
                   href="#"
                   v-on:click.prevent="next">
                    »
                </a>
            </li>

        </ul>
    </nav>

</div>

<script>
    var urlListado = '/Pedido/ListarPedidosCocinero';
</script>


@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="~/js/pedido-list.js"></script>
}
